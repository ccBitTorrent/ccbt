# Bitonic - 终端仪表板

**Bitonic** 是 ccBitTorrent 的主要入口点，提供实时交互式终端仪表板，用于监控和管理种子、对等节点、速度和系统指标。

- 入口点: [ccbt/interface/terminal_dashboard.py:main](https://github.com/yourusername/ccbittorrent/blob/main/ccbt/interface/terminal_dashboard.py#L3914)
- 定义位置: [pyproject.toml:81](https://github.com/yourusername/ccbittorrent/blob/main/pyproject.toml#L81)
- 主类: [ccbt/interface/terminal_dashboard.py:TerminalDashboard](https://github.com/yourusername/ccbittorrent/blob/main/ccbt/interface/terminal_dashboard.py#L3009)

## 启动 Bitonic

使用专用入口点启动 Bitonic:
```bash
uv run bitonic
```

或通过 CLI:
```bash
uv run ccbt dashboard
```

带选项:
```bash
# 自定义刷新间隔（秒）
uv run bitonic --refresh 2.0

# 通过 CLI 使用警报规则
uv run ccbt dashboard --rules /path/to/alert-rules.json
```

实现: [ccbt/cli/monitoring_commands.py:dashboard](https://github.com/yourusername/ccbittorrent/blob/main/ccbt/cli/monitoring_commands.py#L20)

## 完整用户旅程示例

```
用户操作流程:
─────────────────

1. 用户在主仪表板中按下 'o'（高级添加）
   ↓
2. 添加种子屏幕模态框出现
   ↓
3. 步骤 1: 用户输入磁力链接
   → 输入: "magnet:?xt=urn:btih:abc123..."
   → 验证: ✓ 有效的磁力 URI
   → 加载: 种子元数据
   → 点击: [下一步]
   ↓
4. 步骤 2: 用户输入输出目录
   → 输入: "/home/user/downloads"
   → 点击: [下一步]
   ↓
5. 步骤 3: 用户选择文件
   → 选择: 文件 0, 1, 3 (跳过文件 2)
   → 设置: 文件 1 优先级为 "高"
   → 点击: [下一步]
   ↓
6. 步骤 4: 用户设置速率限制
   → 下载: 1000 KiB/s
   → 上传: 500 KiB/s
   → 点击: [下一步]
   ↓
7. 步骤 5: 用户选择队列优先级
   → 选择: "高"
   → 点击: [下一步]
   ↓
8. 步骤 6: 用户启用恢复
   → 开关: 开启
   → 点击: [下一步]
   ↓
9. 步骤 7: 用户启用带去重的 Xet
   → 启用 Xet: 开启
   → 去重: 开启
   → P2P CAS: 关闭
   → 压缩: 关闭
   → 点击: [下一步]
   ↓
10. 步骤 8: 用户跳过 IPFS
    → 启用 IPFS: 关闭
    → 点击: [下一步]
    ↓
11. 步骤 9: 用户启用自动抓取
    → 自动抓取: 开启
    → 点击: [下一步]
    ↓
12. 步骤 10: 用户启用 uTP
    → 启用 uTP: 开启
    → 点击: [下一步]
    ↓
13. 步骤 11: 用户启用 NAT 映射
    → 启用 NAT: 开启
    → 点击: [提交]
    ↓
14. 表单提交
    → 选项字典已构建
    → 模态框已关闭
    → dashboard._process_add_torrent() 调用
    → 已使用所有指定选项添加种子
```


## 终端仪表板可视化

### 主仪表板布局

```
┌─────────────────────────────────────────────────────────────────────────┐
│ Header (with clock)                                                     │
├─────────────────────────────────────────────────────────────────────────┤
│                                                                         │
│  ┌──────────────────────────┐  ┌──────────────────────────────────────┐ │
│  │ LEFT PANEL              │  │ RIGHT PANEL                          │ │
│  │                         │  │                                      │ │
│  │ ┌────────────────────┐  │  │ ┌──────────────────────────────────┐ │ │
│  │ │ Overview           │  │  │ │ Torrents Table                  │ │ │
│  │ │                    │  │  │ │ (2fr height)                    │ │ │
│  │ │ • Torrents         │  │  │ │                                 │ │ │
│  │ │ • Active           │  │  │ │ Info Hash | Name | Status | ... │ │ │
│  │ │ • Paused           │  │  │ │ ─────────────────────────────── │ │ │
│  │ │ • Seeding          │  │  │ │ abc123... | file.torrent | ... │ │ │
│  │ │ • Down Rate        │  │  │ │ def456... | movie.torrent | ... │ │ │
│  │ │ • Up Rate          │  │  │ │ ...                             │ │ │
│  │ │ • Avg Progress     │  │  │ │                                 │ │ │
│  │ │                    │  │  │ └──────────────────────────────────┘ │ │
│  │ └────────────────────┘  │  │                                      │ │
│  │                         │  │ ┌──────────────────────────────────┐ │ │
│  │ ┌────────────────────┐  │  │ │ Peers Table                     │ │ │
│  │ │ Speed Sparklines   │  │  │ │ (1fr height)                    │ │ │
│  │ │                    │  │  │ │                                 │ │ │
│  │ │ 下载: ▁▂▃▅▆▇█  │  │  │ │ IP | Port | Down | Up | ...    │ │ │
│  │ │ 上传:   ▁▂▃▅▆▇█  │  │  │ │ ─────────────────────────────── │ │ │
│  │ │                    │  │  │ │ 192.168.1.1 | 6881 | ...       │ │ │
│  │ └────────────────────┘  │  │ │ ...                             │ │ │
│  │                         │  │ └──────────────────────────────────┘ │ │
│  │                         │  │                                      │ │
│  │                         │  │ ┌──────────────────────────────────┐ │ │
│  │                         │  │ │ Details                          │ │ │
│  │                         │  │ │ (1fr height)                     │ │ │
│  │                         │  │ │ 选择ed torrent details...     │ │ │
│  │                         │  │ └──────────────────────────────────┘ │ │
│  │                         │  │                                      │ │
│  │                         │  │ ┌──────────────────────────────────┐ │ │
│  │                         │  │ │ Logs (RichLog)                  │ │ │
│  │                         │  │ │ (1fr height)                     │ │ │
│  │                         │  │ │ [INFO] Connected to peer...     │ │ │
│  │                         │  │ │ [WARN] Tracker timeout...        │ │ │
│  │                         │  │ │ ...                             │ │ │
│  │                         │  │ └──────────────────────────────────┘ │ │
│  └──────────────────────────┘  └──────────────────────────────────────┘ │
│                                                                         │
├─────────────────────────────────────────────────────────────────────────┤
│ Status Bar                                                              │
├─────────────────────────────────────────────────────────────────────────┤
│ Alerts Container                                                        │
├─────────────────────────────────────────────────────────────────────────┤
│ Footer                                                                  │
└─────────────────────────────────────────────────────────────────────────┘
```

### 键盘快捷键

#### 主仪表板操作
- `p` - 暂停种子
- `r` - 恢复种子
- `q` - 退出
- `i` - 快速添加种子
- `o` - 高级添加种子
- `b` - 浏览添加种子
- `?` - 帮助

#### 配置
- `g` - 全局配置
- `t` - 种子配置

#### 监控屏幕
- `s` - 系统资源
- `m` - 性能指标
- `n` - 网络质量
- `h` - 历史趋势
- `a` - 警报仪表板
- `e` - 指标浏览器
- `x` - 安全扫描

#### 协议管理
- `Ctrl+X` - Xet 管理
- `Ctrl+I` - IPFS 管理
- `Ctrl+S` - SSL 配置
- `Ctrl+P` - 代理配置
- `Ctrl+R` - 抓取结果
- `Ctrl+N` - NAT 管理
- `Ctrl+U` - uTP 配置

#### 导航
- `Ctrl+M` - 导航菜单

## 添加种子 

添加种子屏幕是一个包含 11 个步骤的完整模态表单 引导用户添加种子 包含所有可用的配置选项. 它提供了一个结构化的、用户友好的界面 用于配置具有高级功能的种子下载.

### 流程

```
┌─────────────────────────────────────────────────────────────┐
│                    添加种子流程                      │
├─────────────────────────────────────────────────────────────┤
│                                                             │
│  步骤 1: 种子输入                                      │
│    ↓                                                        │
│  步骤 2: 输出目录                                    │
│    ↓                                                        │
│  Step 3: 文件 选择ion (if applicable)                     │
│    ↓                                                        │
│  步骤 4: 速率限制                                        │
│    ↓                                                        │
│  步骤 5: 队列优先级                                     │
│    ↓                                                        │
│  步骤 6: 恢复选项                                      │
│    ↓                                                        │
│  步骤 7: Xet 协议选项                               │
│    ↓                                                        │
│  步骤 8: IPFS 协议选项                              │
│    ↓                                                        │
│  步骤 9: 抓取选项                                     │
│    ↓                                                        │
│  步骤 10: uTP 协议选项                              │
│    ↓                                                        │
│  步骤 11: NAT 遍历选项                             │
│    ↓                                                        │
│  提交 → 处理种子添加                          │
│                                                             │
└─────────────────────────────────────────────────────────────┘
```

### 步骤 1: 种子输入

```
┌─────────────────────────────────────────────────────────────┐
│ Step 1/11: 1 → 2 → 3 → 4 → 5 → 6 → 7 → 8 → 9 → 10 → 11    │
├─────────────────────────────────────────────────────────────┤
│                                                             │
│ ┌─────────────────────────────────────────────────────────┐ │
│ │ 输入 .torrent 文件路径或磁力链接:    │ │
│ │                                                         │ │
│ │ 示例:                                               │ │
│ │   /path/to/file.torrent                                │ │
│ │   magnet:?xt=urn:btih:...                              │ │
│ └─────────────────────────────────────────────────────────┘ │
│                                                             │
│ ┌─────────────────────────────────────────────────────────┐ │
│ │ [magnet:?xt=urn:btih:abc123def456...________________]  │ │
│ └─────────────────────────────────────────────────────────┘ │
│                                                             │
│ [取消]                    [上一步] [下一步]              │
│                                                             │
└─────────────────────────────────────────────────────────────┘

功能:
- 种子路径或磁力链接 URI 的输入字段
- 帮助 text with examples
- 验证: 必须非空且为有效的种子/磁力链接
- 下一步: 为后续步骤加载种子数据
- 键盘: 输入字段自动获得焦点
```

### 步骤 2: 输出目录

```
┌─────────────────────────────────────────────────────────────┐
│ Step 2/11: ✓ → 2 → 3 → 4 → 5 → 6 → 7 → 8 → 9 → 10 → 11   │
├─────────────────────────────────────────────────────────────┤
│                                                             │
│ ┌─────────────────────────────────────────────────────────┐ │
│ │ 输入文件应下载到的目录:  │ │
│ │                                                         │ │
│ │ 留空以使用当前目录。                  │ │
│ └─────────────────────────────────────────────────────────┘ │
│                                                             │
│ ┌─────────────────────────────────────────────────────────┐ │
│ │ [/home/user/downloads_____________________________]     │ │
│ └─────────────────────────────────────────────────────────┘ │
│                                                             │
│ [取消]                    [上一步] [下一步]              │
│                                                             │
└─────────────────────────────────────────────────────────────┘

功能:
- 输出目录路径的输入字段
- 默认: 当前目录 (.)
- 帮助 text explaining default behavior
- 验证: 目录路径（提交时验证）
- 键盘: 输入字段自动获得焦点
```

### Step 3: 文件 选择ion

```
┌─────────────────────────────────────────────────────────────┐
│ Step 3/11: ✓ → ✓ → 3 → 4 → 5 → 6 → 7 → 8 → 9 → 10 → 11   │
├─────────────────────────────────────────────────────────────┤
│                                                             │
│ ┌─────────────────────────────────────────────────────────┐ │
│ │ 选择要下载的文件并设置优先级:            │ │
│ │   空格: 切换选择                               │ │
│ │   P: 更改优先级                                    │ │
│ │   A: 全选                                        │ │
│ │   D: 取消全选                                      │ │
│ └─────────────────────────────────────────────────────────┘ │
│                                                             │
│ ┌─────────────────────────────────────────────────────────┐ │
│ │ 选择  优先级  大小        文件 Name                 │ │
│ │ ──────────────────────────────────────────────────────── │ │
│ │ ✓        normal    500.00 MB  movie.mp4                │ │
│ │ ✓        high      1.20 GB    movie.mkv                │ │
│ │          normal    300.00 MB  subtitles.srt            │ │
│ │ ✓        low       800.00 MB  trailer.avi              │ │
│ └─────────────────────────────────────────────────────────┘ │
│                                                             │
│ [取消]                    [上一步] [下一步]              │
│                                                             │
└─────────────────────────────────────────────────────────────┘

功能:
- 显示种子中所有文件的 DataTable
- Columns: 选择 (✓/space), 优先级, 大小, 文件 Name
- 使用键盘快捷键进行交互式选择
- 默认: 所有文件以 "正常" 优先级选中
- 验证: 无（可选步骤）
- 特殊情况:
  - 如果种子没有文件: 显示 "此种子没有可选择的文件"
  - 如果种子数据未加载: 显示错误，提示返回
- 键盘: 表格获得焦点，支持导航
```

### 步骤 4: 速率限制

```
┌─────────────────────────────────────────────────────────────┐
│ Step 4/11: ✓ → ✓ → ✓ → 4 → 5 → 6 → 7 → 8 → 9 → 10 → 11   │
├─────────────────────────────────────────────────────────────┤
│                                                             │
│ ┌─────────────────────────────────────────────────────────┐ │
│ │ 为此种子设置速率限制:                      │ │
│ │                                                         │ │
│ │ 输入 0 或留空表示无限制。                  │ │
│ └─────────────────────────────────────────────────────────┘ │
│                                                             │
│ 下载限制 (KiB/s):                                     │
│ ┌─────────────────────────────────────────────────────────┐ │
│ │ [1000_____________________________________________]     │ │
│ └─────────────────────────────────────────────────────────┘ │
│                                                             │
│ 上传限制 (KiB/s):                                       │
│ ┌─────────────────────────────────────────────────────────┐ │
│ │ [500______________________________________________]     │ │
│ └─────────────────────────────────────────────────────────┘ │
│                                                             │
│ [取消]                    [上一步] [下一步]              │
│                                                             │
└─────────────────────────────────────────────────────────────┘

功能:
- 两个输入字段: 下载和上传限制
- 单位: KiB/s (千二进制字节/秒)
- 默认: 0 (无限制)
- 验证: 必须是非负整数
- 帮助 text explaining unlimited option
- 键盘: 下载限制字段首先获得焦点
```

### 步骤 5: 队列优先级

```
┌─────────────────────────────────────────────────────────────┐
│ Step 5/11: ✓ → ✓ → ✓ → ✓ → 5 → 6 → 7 → 8 → 9 → 10 → 11   │
├─────────────────────────────────────────────────────────────┤
│                                                             │
│ ┌─────────────────────────────────────────────────────────┐ │
│ │ 选择此种子的队列优先级:                 │ │
│ │                                                         │ │
│ │ Higher 优先级为rrents will be started first.         │ │
│ └─────────────────────────────────────────────────────────┘ │
│                                                             │
│ ┌─────────────────────────────────────────────────────────┐ │
│ │ 优先级: [▼ Normal                    ]               │ │
│ │                                                         │ │
│ │ Options:                                               │ │
│ │   • Maximum                                            │ │
│ │   • High                                               │ │
│ │   • Normal  ← 选择ed                                 │ │
│ │   • Low                                                │ │
│ │   • Paused                                             │ │
│ └─────────────────────────────────────────────────────────┘ │
│                                                             │
│ [取消]                    [上一步] [下一步]              │
│                                                             │
└─────────────────────────────────────────────────────────────┘

功能:
- 选择 widget with priority options
- 选项: 最大、高、正常、低、暂停
- 默认: 正常
- 帮助 text explaining priority system
- Keyboard: 选择 widget is focused
```

### 步骤 6: 恢复选项

```
┌─────────────────────────────────────────────────────────────┐
│ Step 6/11: ✓ → ✓ → ✓ → ✓ → ✓ → 6 → 7 → 8 → 9 → 10 → 11   │
├─────────────────────────────────────────────────────────────┤
│                                                             │
│ ┌─────────────────────────────────────────────────────────┐ │
│ │ 如果可用，从检查点恢复:                   │ │
│ │                                                         │ │
│ │ If enabled, the download will resume from the last     │ │
│ │ checkpoint.                                            │ │
│ └─────────────────────────────────────────────────────────┘ │
│                                                             │
│ 从检查点恢复: [ ]                                │
│                          ↑                                  │
│                      Switch (关闭)                           │
│                                                             │
│ [取消]                    [上一步] [下一步]              │
│                                                             │
└─────────────────────────────────────────────────────────────┘

功能:
- 恢复选项的开关小部件
- 默认: False (禁用)
- 帮助 text explaining checkpoint resume functionality
- 键盘: 开关获得焦点
```

### 步骤 7: Xet 协议选项

```
┌─────────────────────────────────────────────────────────────┐
│ Step 7/11: ✓ → ✓ → ✓ → ✓ → ✓ → ✓ → 7 → 8 → 9 → 10 → 11   │
├─────────────────────────────────────────────────────────────┤
│                                                             │
│ ┌─────────────────────────────────────────────────────────┐ │
│ │ Xet 协议选项:                                  │ │
│ │                                                         │ │
│ │ Xet 启用内容定义的块和去重。│ │
│ │ Useful for reducing storage when downloading similar   │ │
│ │ content.                                               │ │
│ └─────────────────────────────────────────────────────────┘ │
│                                                             │
│ 启用 Xet 协议:              [ ]                       │
│ Enable 去重:            [ ]                       │
│ 启用 P2P 内容寻址存储: [ ]                  │
│ Enable 压缩:               [ ]                      │
│                                                             │
│ Press Ctrl+X in main dashboard to manage Xet settings      │
│ globally                                                    │
│                                                             │
│ [取消]                    [上一步] [下一步]              │
│                                                             │
└─────────────────────────────────────────────────────────────┘

功能:
- Xet 选项的四个开关小部件:
  1. 启用 Xet 协议 (主开关)
  2. 启用去重
  3. 启用 P2P 内容寻址存储
  4. 启用压缩
- 默认: 全部禁用
- 帮助 text explaining Xet protocol benefits
- 链接到全局 Xet 管理屏幕 (Ctrl+X)
- 键盘: 第一个开关 (启用 Xet) 获得焦点
```

### 步骤 8: IPFS 协议选项

```
┌─────────────────────────────────────────────────────────────┐
│ Step 8/11: ✓ → ✓ → ✓ → ✓ → ✓ → ✓ → ✓ → 8 → 9 → 10 → 11   │
├─────────────────────────────────────────────────────────────┤
│                                                             │
│ ┌─────────────────────────────────────────────────────────┐ │
│ │ IPFS 协议选项:                                  │ │
│ │                                                         │ │
│ │ IPFS enables content-addressed storage and peer-to-peer │ │
│ │ content sharing. Content can be accessed via IPFS CID  │ │
│ │ after download.                                         │ │
│ └─────────────────────────────────────────────────────────┘ │
│                                                             │
│ 启用 IPFS 协议:          [ ]                         │
│ 在 IPFS 中固定内容:           [ ]                         │
│                                                             │
│ Press Ctrl+I in main dashboard to manage IPFS content and  │
│ peers                                                       │
│                                                             │
│ [取消]                    [上一步] [下一步]              │
│                                                             │
└─────────────────────────────────────────────────────────────┘

功能:
- IPFS 选项的两个开关小部件:
  1. 启用 IPFS 协议 (主开关)
  2. 在 IPFS 中固定内容
- 默认: 两者都禁用
- 帮助 text explaining IPFS protocol benefits
- 链接到全局 IPFS 管理屏幕 (Ctrl+I)
- 键盘: 第一个开关 (启用 IPFS) 获得焦点
```

### 步骤 9: 抓取选项

```
┌─────────────────────────────────────────────────────────────┐
│ Step 9/11: ✓ → ✓ → ✓ → ✓ → ✓ → ✓ → ✓ → ✓ → 9 → 10 → 11   │
├─────────────────────────────────────────────────────────────┤
│                                                             │
│ ┌─────────────────────────────────────────────────────────┐ │
│ │ 抓取选项:                                         │ │
│ │                                                         │ │
│ │ Scraping queries tracker statistics (seeders, leechers, │ │
│ │ completed downloads). Auto-scrape will automatically   │ │
│ │ scrape the tracker when the torrent is added.           │ │
│ └─────────────────────────────────────────────────────────┘ │
│                                                             │
│ 添加时自动抓取:            [ ]                         │
│                                                             │
│ 在主仪表板中按 Ctrl+R 查看抓取结果      │
│                                                             │
│ [取消]                    [上一步] [下一步]              │
│                                                             │
└─────────────────────────────────────────────────────────────┘

功能:
- 自动抓取选项的单个开关小部件
- 默认: 禁用
- 帮助 text explaining scraping functionality
- 链接到抓取结果屏幕 (Ctrl+R)
- 键盘: 开关获得焦点
```

### 步骤 10: uTP 协议选项

```
┌─────────────────────────────────────────────────────────────┐
│ Step 10/11: ✓ → ✓ → ✓ → ✓ → ✓ → ✓ → ✓ → ✓ → ✓ → 10 → 11 │
├─────────────────────────────────────────────────────────────┤
│                                                             │
│ ┌─────────────────────────────────────────────────────────┐ │
│ │ uTP (uTorrent 传输协议) 选项:             │ │
│ │                                                         │ │
│ │ uTP provides reliable, ordered delivery over UDP with  │ │
│ │ delay-based congestion control (BEP 29). Useful for    │ │
│ │ better performance on networks with high latency or     │ │
│ │ packet loss.                                            │ │
│ └─────────────────────────────────────────────────────────┘ │
│                                                             │
│ 启用 uTP 传输:          [ ]                        │
│                                                             │
│ Press Ctrl+U in main dashboard to configure uTP settings   │
│ globally                                                    │
│                                                             │
│ [取消]                    [上一步] [下一步]              │
│                                                             │
└─────────────────────────────────────────────────────────────┘

功能:
- uTP 选项的单个开关小部件
- 默认: 禁用
- 帮助 text explaining uTP protocol benefits (BEP 29)
- 链接到全局 uTP 配置屏幕 (Ctrl+U)
- 键盘: 开关获得焦点
```

### 步骤 11: NAT 遍历选项

```
┌─────────────────────────────────────────────────────────────┐
│ Step 11/11: ✓ → ✓ → ✓ → ✓ → ✓ → ✓ → ✓ → ✓ → ✓ → ✓ → 11  │
├─────────────────────────────────────────────────────────────┤
│                                                             │
│ ┌─────────────────────────────────────────────────────────┐ │
│ │ NAT 遍历选项:                                  │ │
│ │                                                         │ │
│ │ NAT traversal (NAT-PMP/UPnP) automatically maps ports  │ │
│ │ on your router. This allows peers to connect to you    │ │
│ │ directly, improving download speeds.                    │ │
│ └─────────────────────────────────────────────────────────┘ │
│                                                             │
│ 启用 NAT 端口映射:       [ ]                        │
│                                                             │
│ Press Ctrl+N in main dashboard to manage NAT settings      │
│ globally                                                    │
│                                                             │
│ [取消]                    [上一步] [提交]            │
│                                                             │
└─────────────────────────────────────────────────────────────┘

功能:
- NAT 映射选项的单个开关小部件
- 默认: 禁用
- 帮助 text explaining NAT traversal benefits
- 链接到全局 NAT 管理屏幕 (Ctrl+N)
- 键盘: 开关获得焦点
- 注意: "下一步" 按钮在最后一步变为 "提交"
```



## Widget Hierarchy

```
TerminalDashboard (App)
├── Header (with clock)
├── Horizontal (#body)
│   ├── Container (#left)
│   │   ├── Overview (#overview)
│   │   │   └── Rich Table (Torrents, Active, Paused, Seeding, Rates, Progress)
│   │   └── SpeedSparklines (#speeds)
│   │       ├── Sparkline (Download)
│   │       └── Sparkline (Upload)
│   └── Container (#right)
│       ├── TorrentsTable (#torrents)
│       │   └── DataTable columns: Info Hash, Name, Status, Progress, Down/Up
│       ├── PeersTable (#peers)
│       │   └── DataTable columns: IP, Port, Down, Up, Latency, Quality, Health, Choked, Client
│       ├── Static (#details)
│       └── RichLog (#logs)
├── Static (#statusbar)
├── Container
│   └── Static (#alerts)
└── Footer
```


## Available Screens

### Monitoring Screens
1. **SystemResourcesScreen** - CPU, memory, disk, network usage
2. **PerformanceMetricsScreen** - Performance metrics from MetricsCollector
3. **NetworkQualityScreen** - Network quality metrics for peers
4. **HistoricalTrendsScreen** - Historical trends with sparklines
5. **AlertsDashboardScreen** - Enhanced alerts with filtering
6. **MetricsExplorerScreen** - Explore all metrics with export
7. **QueueMetricsScreen** - Queue metrics (position, priority, waiting time)
8. **DiskIOMetricsScreen** - Disk I/O statistics
9. **TrackerMetricsScreen** - Tracker metrics (announce/scrape success)
10. **PerformanceAnalysisScreen** - Performance analysis from CLI
11. **DiskAnalysisScreen** - Disk analysis from disk-detect/stats

### Configuration Screens
1. **GlobalConfigMainScreen** - Main global config with section selector
2. **GlobalConfigDetailScreen** - Detail screen for global config sections
3. **PerTorrentConfigMainScreen** - Main per-torrent config with torrent selector
4. **TorrentConfigDetailScreen** - Detail screen for per-torrent config

### Protocol Management Screens
1. **XetManagementScreen** - Xet protocol management
2. **IPFSManagementScreen** - IPFS protocol management
3. **SSLConfigScreen** - SSL/TLS configuration
4. **ProxyConfigScreen** - Proxy configuration
5. **ScrapeResultsScreen** - View cached scrape results
6. **NATManagementScreen** - NAT traversal (NAT-PMP, UPnP)
7. **UTPConfigScreen** - uTP configuration

### Utility Screens
1. **帮助Screen** - Keyboard shortcuts and help
2. **NavigationMenuScreen** - Navigation menu/sidebar
3. **AddTorrentScreen** - Advanced torrent addition (multi-step form)
4. **文件选择ionScreen** - 文件 selection management
5. **ConfirmationDialog** - Modal confirmation dialog

## Screen Layout Examples

### 系统资源 Screen
```
┌─────────────────────────────────────────────────────────┐
│ Header                                                   │
├─────────────────────────────────────────────────────────┤
│ ┌─────────────────────────────────────────────────────┐ │
│ │ 系统资源                                     │ │
│ │ Resource    Usage    Progress                        │ │
│ │ ─────────────────────────────────────────────────── │ │
│ │ CPU         75.0%    ████████████████░░░░░░░░        │ │
│ │ Memory      85.0%    ████████████████████░░░░        │ │
│ │ Disk        60.0%    ████████████░░░░░░░░░░░░        │ │
│ │ Processes   142      (no progress bar)               │ │
│ └─────────────────────────────────────────────────────┘ │
│ ┌─────────────────────────────────────────────────────┐ │
│ │ Network I/O                                          │ │
│ │ Direction   Bytes          Formatted                │ │
│ │ ─────────────────────────────────────────────────── │ │
│ │ Sent        1,234,567,890  1.15 GB                   │ │
│ │ Received    987,654,321    941.89 MB                 │ │
│ └─────────────────────────────────────────────────────┘ │
├─────────────────────────────────────────────────────────┤
│ Footer (Back: Esc, 退出: q)                             │
└─────────────────────────────────────────────────────────┘
```

### 性能指标 Screen
```
┌─────────────────────────────────────────────────────────┐
│ Header                                                   │
├─────────────────────────────────────────────────────────┤
│ ┌─────────────────────────────────────────────────────┐ │
│ │ 性能指标                                 │ │
│ │ Metric              Value      Description          │ │
│ │ ─────────────────────────────────────────────────── │ │
│ │ Peer Connections    45         Total connected...   │ │
│ │ Download Speed      2.5 MB/s   Global download...   │ │
│ │ Upload Speed        1.2 MB/s   Global upload...     │ │
│ │ Pieces Completed    1,234      Successfully...       │ │
│ │ Pieces Failed       5          Failed piece...       │ │
│ │ Tracker Requests    89         Total tracker...      │ │
│ │ Tracker Responses   87         Successful...         │ │
│ │ Tracker Success     97.8%      Response success...  │ │
│ └─────────────────────────────────────────────────────┘ │
│ ┌─────────────────────────────────────────────────────┐ │
│ │ Event-Driven Metrics (MetricsPlugin)                │ │
│ │ Metric          Count  Avg    Min    Max    Sum     │ │
│ │ ─────────────────────────────────────────────────── │ │
│ │ download_speed  1000   2.5MB  0.1MB  5.0MB  2.5GB   │ │
│ │ upload_speed    1000   1.2MB  0.05MB 3.0MB  1.2GB   │ │
│ └─────────────────────────────────────────────────────┘ │
│ ┌─────────────────────────────────────────────────────┐ │
│ │ Statistics                                          │ │
│ │ Metric              Value                            │ │
│ │ ─────────────────────────────────────────────────── │ │
│ │ Total Metrics       25                              │ │
│ │ Active Metrics      20                              │ │
│ └─────────────────────────────────────────────────────┘ │
├─────────────────────────────────────────────────────────┤
│ Footer (Back: Esc, 退出: q)                             │
└─────────────────────────────────────────────────────────┘
```

### 网络质量 Screen
```
┌─────────────────────────────────────────────────────────┐
│ Header                                                   │
├─────────────────────────────────────────────────────────┤
│ ┌─────────────────────────────────────────────────────┐ │
│ │ Global Network Statistics                          │ │
│ │ Metric                  Value                      │ │
│ │ ─────────────────────────────────────────────────── │ │
│ │ Total Torrents          5                          │ │
│ │ Active Torrents         3                          │ │
│ │ Global Download Rate    2.5 MB/s                   │ │
│ │ Global Upload Rate      1.2 MB/s                   │ │
│ │ Download Utilization    62.5%                      │ │
│ │ Upload Utilization      60.0%                      │ │
│ └─────────────────────────────────────────────────────┘ │
│ ┌─────────────────────────────────────────────────────┐ │
│ │ Per-Torrent 网络质量                        │ │
│ │ Torrent        Down Rate  Up Rate  Progress Status │ │
│ │ ─────────────────────────────────────────────────── │ │
│ │ example.torrent 1.2 MB/s  500 KB/s  45%   Active   │ │
│ │ movie.torrent   800 KB/s  300 KB/s  78%   Seeding  │ │
│ └─────────────────────────────────────────────────────┘ │
│ ┌─────────────────────────────────────────────────────┐ │
│ │ Peer Metrics Summary                                │ │
│ │ Metric                      Value                   │ │
│ │ ─────────────────────────────────────────────────── │ │
│ │ Total Peers                  25                     │ │
│ │ Choked Peers                 8                      │ │
│ │ Unchoke Ratio                68.0%                   │ │
│ │ Average Latency               45.2 ms                │ │
│ │ Piece Request Success Rate    95.5%                  │ │
│ └─────────────────────────────────────────────────────┘ │
│ ┌─────────────────────────────────────────────────────┐ │
│ │ Peer Quality (Torrent: abc123...)                   │ │
│ │ IP            Down      Up      Quality            │ │
│ │ ─────────────────────────────────────────────────── │ │
│ │ 192.168.1.1   1.2 MB/s  500 KB/s  85% ████████     │ │
│ │ 10.0.0.5      800 KB/s  300 KB/s  70% ██████░░     │ │
│ └─────────────────────────────────────────────────────┘ │
├─────────────────────────────────────────────────────────┤
│ Footer (Back: Esc, 退出: q)                             │
└─────────────────────────────────────────────────────────┘
```

### 历史趋势 Screen
```
┌─────────────────────────────────────────────────────────┐
│ Header                                                   │
├─────────────────────────────────────────────────────────┤
│ ┌─────────────────────────────────────────────────────┐ │
│ │ 历史趋势                                  │ │
│ │ Metric              Current    Trend               │ │
│ │ ─────────────────────────────────────────────────── │ │
│ │ Download Speed      2.5 MB/s   ▁▂▃▅▆▇█            │ │
│ │ Upload Speed        1.2 MB/s   ▁▂▃▅▆▇█            │ │
│ │ Peer Connections    45         ▁▂▃▅▆▇█            │ │
│ │ Pieces Completed    1,234       ▁▂▃▅▆▇█            │ │
│ │ Tracker Success     97.8%       ▁▂▃▅▆▇█            │ │
│ └─────────────────────────────────────────────────────┘ │
│ ┌─────────────────────────────────────────────────────┐ │
│ │ Sparklines Group                                    │ │
│ │ [Download Speed Sparkline]                          │ │
│ │ [Upload Speed Sparkline]                            │ │
│ │ [Peer Connections Sparkline]                       │ │
│ └─────────────────────────────────────────────────────┘ │
├─────────────────────────────────────────────────────────┤
│ Footer (Back: Esc, 退出: q)                             │
└─────────────────────────────────────────────────────────┘
```

### 警报仪表板 Screen
```
┌─────────────────────────────────────────────────────────┐
│ Header                                                   │
├─────────────────────────────────────────────────────────┤
│ ┌─────────────────────────────────────────────────────┐ │
│ │ Alert Rules                                         │ │
│ │ Name        Metric          Condition    Severity  │ │
│ │ ─────────────────────────────────────────────────── │ │
│ │ high_cpu    cpu_usage        > 80%        WARNING   │ │
│ │ low_disk    disk_usage      > 90%        ERROR      │ │
│ │ slow_dl     download_speed   < 100 KB/s  WARNING   │ │
│ └─────────────────────────────────────────────────────┘ │
│ ┌─────────────────────────────────────────────────────┐ │
│ │ Active Alerts                                       │ │
│ │ Severity  Rule        Metric        Value    Time   │ │
│ │ ─────────────────────────────────────────────────── │ │
│ │ WARNING   high_cpu    cpu_usage     85%      14:32  │ │
│ │ ERROR     low_disk    disk_usage    92%      14:30  │ │
│ └─────────────────────────────────────────────────────┘ │
│ ┌─────────────────────────────────────────────────────┐ │
│ │ Alert History (Last 50)                             │ │
│ │ Severity  Rule        Value    Time      Resolved  │ │
│ │ ─────────────────────────────────────────────────── │ │
│ │ WARNING   high_cpu    85%      14:32:15  No        │ │
│ │ ERROR     low_disk    92%      14:30:10  No        │ │
│ │ WARNING   slow_dl     50 KB/s  14:25:00  Yes       │ │
│ └─────────────────────────────────────────────────────┘ │
│ ┌─────────────────────────────────────────────────────┐ │
│ │ Alert Statistics                                    │ │
│ │ Statistic              Value                       │ │
│ │ ─────────────────────────────────────────────────── │ │
│ │ Alerts Triggered       15                          │ │
│ │ Alerts Resolved        8                           │ │
│ │ Notifications Sent     12                          │ │
│ │ Notification Failures  0                           │ │
│ │ Suppressed Alerts      2                           │ │
│ └─────────────────────────────────────────────────────┘ │
├─────────────────────────────────────────────────────────┤
│ Footer (Back: Esc, 退出: q)                             │
└─────────────────────────────────────────────────────────┘
```

### 指标浏览器 Screen
```
┌─────────────────────────────────────────────────────────┐
│ Header                                                   │
├─────────────────────────────────────────────────────────┤
│ Filter: [download________________________________]      │
├─────────────────────────────────────────────────────────┤
│ ┌─────────────────────────────────────────────────────┐ │
│ │ Metrics Table                                       │ │
│ │ Metric Name        Type      Current Value  Desc   │ │
│ │ ─────────────────────────────────────────────────── │ │
│ │ download_speed     gauge     2.5 MB/s       ...    │ │
│ │ upload_speed       gauge     1.2 MB/s       ...    │ │
│ │ peer_connections   counter   45             ...    │ │
│ │ pieces_completed   counter   1,234          ...    │ │
│ └─────────────────────────────────────────────────────┘ │
│ ┌─────────────────────────────────────────────────────┐ │
│ │ Metric Details                                      │ │
│ │ Name: download_speed                                │ │
│ │ Type: gauge                                         │ │
│ │ Current Value: 2.5 MB/s                            │ │
│ │ Description: Global download speed in bytes/sec     │ │
│ │ Unit: bytes/sec                                     │ │
│ │ Min: 0.0                                            │ │
│ │ Max: 10.0 MB/s                                      │ │
│ └─────────────────────────────────────────────────────┘ │
├─────────────────────────────────────────────────────────┤
│ Footer (Back: Esc, 退出: q, Export: e/p)               │
└─────────────────────────────────────────────────────────┘
```

### Queue Metrics Screen
```
┌─────────────────────────────────────────────────────────┐
│ Header                                                   │
├─────────────────────────────────────────────────────────┤
│ ┌─────────────────────────────────────────────────────┐ │
│ │ Queue Statistics                                    │ │
│ │ Metric              Value      Description          │ │
│ │ ─────────────────────────────────────────────────── │ │
│ │ Total Torrents      10         Total torrents...    │ │
│ │ Active Downloading  3          Currently...         │ │
│ │ Active Seeding      2          Currently...         │ │
│ │ Queued              5          Torrents waiting... │ │
│ │ Paused              0          Paused torrents      │ │
│ │                                                     │ │
│ │ By 优先级                                         │ │
│ │   Maximum           1          Torrents with...     │ │
│ │   High              2          Torrents with...     │ │
│ │   Normal            5          Torrents with...     │ │
│ │   Low               2          Torrents with...     │ │
│ └─────────────────────────────────────────────────────┘ │
│ ┌─────────────────────────────────────────────────────┐ │
│ │ Queue Summary                                       │ │
│ │ Metric              Value                          │ │
│ │ ─────────────────────────────────────────────────── │ │
│ │ Queue Length        10                             │ │
│ │ Queued (Waiting)    5                              │ │
│ │ Active              5                              │ │
│ │ Avg Waiting Time    15m                            │ │
│ └─────────────────────────────────────────────────────┘ │
│ ┌─────────────────────────────────────────────────────┐ │
│ │ Queue Entries                                       │ │
│ │ Pos  Torrent        优先级  Status    Wait  Down │ │
│ │ ─────────────────────────────────────────────────── │ │
│ │ 1    example.torrent Maximum   Active   0s    1000 │ │
│ │ 2    movie.torrent   High      Active   5m    800   │ │
│ │ 3    file.torrent    Normal    Queued   10m   -    │ │
│ └─────────────────────────────────────────────────────┘ │
├─────────────────────────────────────────────────────────┤
│ Footer (Back: Esc, 退出: q)                             │
└─────────────────────────────────────────────────────────┘
```

### Disk I/O Metrics Screen
```
┌─────────────────────────────────────────────────────────┐
│ Header                                                   │
├─────────────────────────────────────────────────────────┤
│ ┌─────────────────────────────────────────────────────┐ │
│ │ Disk I/O Statistics                                 │ │
│ │ Metric              Value      Description          │ │
│ │ ─────────────────────────────────────────────────── │ │
│ │ Total Writes        1,234,567  Number of write...   │ │
│ │ Bytes Written       5.2 GB     Total bytes...       │ │
│ │ Queue Full Errors   5          Times write...        │ │
│ │ Preallocations      100        文件 preallocation... │ │
│ │ io_uring Operations 50,000     Operations using...   │ │
│ │ Queue Depth         15/100     Current queue...      │ │
│ └─────────────────────────────────────────────────────┘ │
│ ┌─────────────────────────────────────────────────────┐ │
│ │ Cache Statistics                                    │ │
│ │ Metric              Value      Description          │ │
│ │ ─────────────────────────────────────────────────── │ │
│ │ Cache Entries       500        Number of cached...  │ │
│ │ Cache 大小          2.5 GB     Total size of...      │ │
│ │ Cache Hits          10,000     Successful cache...  │ │
│ │ Cache Misses        500        Failed cache...       │ │
│ │ Hit Rate            95.2%      Cache hit percentage │ │
│ │ Bytes Served        1.5 GB     Bytes served from...  │ │
│ │ Cache Efficiency    92.5%      Cache efficiency...  │ │
│ │ Evictions           50         Cache entries...      │ │
│ └─────────────────────────────────────────────────────┘ │
│ ┌─────────────────────────────────────────────────────┐ │
│ │ Disk I/O Configuration                              │ │
│ │ Setting              Value                          │ │
│ │ ─────────────────────────────────────────────────── │ │
│ │ Max Workers         8                              │ │
│ │ Queue 大小          100                            │ │
│ │ Cache 大小          512 MB                         │ │
│ │ Storage Type        NVME                           │ │
│ │ io_uring Enabled    Yes                            │ │
│ │ Direct I/O Enabled  Yes                            │ │
│ │ NVMe Optimized      Yes                            │ │
│ │ Write Cache Enabled Yes                            │ │
│ │ Adaptive Workers    Active                         │ │
│ └─────────────────────────────────────────────────────┘ │
├─────────────────────────────────────────────────────────┤
│ Footer (Back: Esc, 退出: q)                             │
└─────────────────────────────────────────────────────────┘
```

### Tracker Metrics Screen
```
┌─────────────────────────────────────────────────────────┐
│ Header                                                   │
├─────────────────────────────────────────────────────────┤
│ ┌─────────────────────────────────────────────────────┐ │
│ │ Tracker Statistics                                  │ │
│ │ Tracker        Requests  Avg Response  Error  Reuse │ │
│ │ ─────────────────────────────────────────────────── │ │
│ │ tracker1.com   1,234     45.2 ms       0.00%  95%   │ │
│ │ tracker2.org  567       120.5 ms      2.50%  90%   │ │
│ └─────────────────────────────────────────────────────┘ │
│ ┌─────────────────────────────────────────────────────┐ │
│ │ Summary                                             │ │
│ │ Metric              Value                          │ │
│ │ ─────────────────────────────────────────────────── │ │
│ │ Total Trackers      2                              │ │
│ │ Total Requests      1,801                          │ │
│ │ Total Errors        14                             │ │
│ │ Success Rate        99.22%                         │ │
│ │ Avg Response Time   67.8 ms                        │ │
│ └─────────────────────────────────────────────────────┘ │
│ ┌─────────────────────────────────────────────────────┐ │
│ │ Tracker Sessions                                    │ │
│ │ URL            Last Announce  Interval  Fail Status│ │
│ │ ─────────────────────────────────────────────────── │ │
│ │ tracker1.com   2m ago         30m       0   Healthy │ │
│ │ tracker2.org   5m ago         60m       1   Degraded │ │
│ └─────────────────────────────────────────────────────┘ │
├─────────────────────────────────────────────────────────┤
│ Footer (Back: Esc, 退出: q)                             │
└─────────────────────────────────────────────────────────┘
```

### 导航菜单 Screen
```
┌─────────────────────────────────────────────────────────┐
│ Header                                                   │
├─────────────────────────────────────────────────────────┤
│ ┌─────────────────────────────────────────────────────┐ │
│ │ 导航菜单                                      │ │
│ │ Category      Screen              Shortcut          │ │
│ │ ─────────────────────────────────────────────────── │ │
│ │ Monitoring    系统资源    s                │ │
│ │ Monitoring    性能指标 m                │ │
│ │ Monitoring    网络质量     n                │ │
│ │ Monitoring    历史趋势   h                │ │
│ │ Monitoring    警报仪表板    a                │ │
│ │ Monitoring    指标浏览器    e                │ │
│ │ Monitoring    Queue Metrics      u                │ │
│ │ Monitoring    Disk I/O Metrics   j                │ │
│ │ Monitoring    Tracker Metrics    k                │ │
│ │ Configuration Global Config      g                │ │
│ │ Configuration Torrent Config     t                │ │
│ │ Protocols     Xet 管理     Ctrl+X            │ │
│ │ Protocols     IPFS 管理    Ctrl+I            │ │
│ │ Protocols     SSL 配置         Ctrl+S            │ │
│ │ Protocols     代理配置       Ctrl+P            │ │
│ │ Protocols     NAT 管理     Ctrl+N            │ │
│ │ Protocols     uTP 配置         Ctrl+U            │ │
│ └─────────────────────────────────────────────────────┘ │
│ ┌─────────────────────────────────────────────────────┐ │
│ │ 导航菜单                                      │ │
│ │ 选择 a screen to open. Press Enter to navigate,  │ │
│ │ Escape to go back.                                  │ │
│ └─────────────────────────────────────────────────────┘ │
├─────────────────────────────────────────────────────────┤
│ Footer (Back: Esc, 退出: q)                             │
└─────────────────────────────────────────────────────────┘
```

### 帮助 Screen
```
┌─────────────────────────────────────────────────────────┐
│ Header                                                   │
├─────────────────────────────────────────────────────────┤
│ ┌─────────────────────────────────────────────────────┐ │
│ │ Keyboard Shortcuts                                  │ │
│ │ Key         Action              Description         │ │
│ │ ─────────────────────────────────────────────────── │ │
│ │ p           暂停种子       Pause selected...   │ │
│ │ r           恢复种子      Resume selected...  │ │
│ │ q           退出                 Exit dashboard      │ │
│ │ i           Quick Add           Quick torrent add   │ │
│ │ o           Advanced Add         Advanced torrent... │ │
│ │ g           Global Config        Open global...      │ │
│ │ t           Torrent Config       Open per-torrent... │ │
│ │ s           系统资源     Open system...      │ │
│ │ m           性能指标 Open performance... │ │
│ │ n           网络质量      Open network...     │ │
│ │ h           历史趋势   Open historical...  │ │
│ │ a           警报仪表板     Open alerts...      │ │
│ │ e           指标浏览器    Open metrics...      │ │
│ │ ?           帮助                 Show this help     │ │
│ │ Ctrl+M      导航菜单     Open navigation...  │ │
│ └─────────────────────────────────────────────────────┘ │
├─────────────────────────────────────────────────────────┤
│ Footer (Back: Esc, 退出: q)                             │
└─────────────────────────────────────────────────────────┘
```

### Global Config Main Screen
```
┌─────────────────────────────────────────────────────────┐
│ Header                                                   │
├─────────────────────────────────────────────────────────┤
│ ┌─────────────────────────────────────────────────────┐ │
│ │ Configuration Sections                              │ │
│ │ Section              Description          Modified │ │
│ │ ─────────────────────────────────────────────────── │ │
│ │ network              Network configuration...        │ │
│ │ network.protocol_v2  BitTorrent Protocol...         │ │
│ │ network.utp          uTP transport...               │ │
│ │ disk                 Disk I/O configuration...       │ │
│ │ disk.attributes      文件 attributes...              │ │
│ │ disk.xet             Xet protocol...                │ │
│ │ strategy             Piece selection...              │ │
│ │ discovery            Peer discovery...               │ │
│ │ observability        Logging, metrics...             │ │
│ │ limits               Rate limit...                   │ │
│ │ security             Security settings...            │ │
│ │ security.ip_filter   IP filtering...                │ │
│ │ security.ssl         SSL/TLS settings...            │ │
│ │ proxy                Proxy configuration            │ │
│ │ ml                   Machine learning...             │ │
│ │ dashboard            Dashboard/web UI...             │ │
│ │ queue                Torrent queue...                │ │
│ │ nat                  NAT traversal...                │ │
│ │ ipfs                 IPFS protocol...                │ │
│ │ webtorrent           WebTorrent protocol...          │ │
│ └─────────────────────────────────────────────────────┘ │
│ ┌─────────────────────────────────────────────────────┐ │
│ │ Global Configuration                                │ │
│ │ 选择 a section to configure. Press Enter to edit, │ │
│ │ Escape to go back.                                  │ │
│ └─────────────────────────────────────────────────────┘ │
├─────────────────────────────────────────────────────────┤
│ Footer (Back: Esc, 退出: q)                             │
└─────────────────────────────────────────────────────────┘
```

### Global Config Detail Screen
```
┌─────────────────────────────────────────────────────────┐
│ Header                                                   │
├─────────────────────────────────────────────────────────┤
│ ┌─────────────────────────────────────────────────────┐ │
│ │ Network Configuration                               │ │
│ │ Option          Current Value    Type               │ │
│ │ ─────────────────────────────────────────────────── │ │
│ │ max_connections 200              number             │ │
│ │ max_peers       50                number             │ │
│ │ connect_timeout 30                number             │ │
│ │ enable_utp       true              bool               │ │
│ └─────────────────────────────────────────────────────┘ │
│ ┌─────────────────────────────────────────────────────┐ │
│ │ 性能指标                                 │ │
│ │ [Metrics displayed here]                            │ │
│ └─────────────────────────────────────────────────────┘ │
│ ┌─────────────────────────────────────────────────────┐ │
│ │ Configuration Editors                               │ │
│ │ max_connections: Network max connections            │ │
│ │ [200________________________________]              │ │
│ │ max_peers: Maximum peers per torrent                │ │
│ │ [50_________________________________]              │ │
│ │ connect_timeout: Connection timeout in seconds     │ │
│ │ [30_________________________________]              │ │
│ │ enable_utp: Enable uTP transport                    │ │
│ │ [✓] Enable uTP                                      │ │
│ └─────────────────────────────────────────────────────┘ │
│ ┌─────────────────────────────────────────────────────┐ │
│ │ Errors                                              │ │
│ │ (Validation errors appear here)                    │ │
│ └─────────────────────────────────────────────────────┘ │
│ [Save (Runtime)] [Save to 文件] [取消]               │
├─────────────────────────────────────────────────────────┤
│ Footer (Back: Esc, 退出: q)                             │
└─────────────────────────────────────────────────────────┘
```

### Per-Torrent Config Main Screen
```
┌─────────────────────────────────────────────────────────┐
│ Header                                                   │
├─────────────────────────────────────────────────────────┤
│ ┌──────────────────────────────────┐ ┌────────────────┐ │
│ │ Torrents                         │ │ Summary        │ │
│ │ Info Hash  Name      Status ...   │ │ Key      Value │ │
│ │ ──────────────────────────────── │ │ ─────────────── │ │
│ │ abc123...  example   Active 45%   │ │ Total    10    │ │
│ │ def456...  movie     Seeding 100% │ │ With     5     │ │
│ │ ghi789...  file      Active 78%   │ │ Without  5     │ │
│ │ ...                               │ │                │ │
│ └──────────────────────────────────┘ └────────────────┘ │
│ ┌─────────────────────────────────────────────────────┐ │
│ │ Per-Torrent Configuration                           │ │
│ │ 选择 a torrent to configure. Press Enter to edit, │ │
│ │ Escape to go back.                                  │ │
│ └─────────────────────────────────────────────────────┘ │
├─────────────────────────────────────────────────────────┤
│ Footer (Back: Esc, 退出: q)                             │
└─────────────────────────────────────────────────────────┘
```

### Torrent Config Detail Screen
```
┌─────────────────────────────────────────────────────────┐
│ Header                                                   │
├─────────────────────────────────────────────────────────┤
│ ┌─────────────────────────────────────────────────────┐ │
│ │ Rate Limit Configuration                            │ │
│ │ Setting         Current Value    Description        │ │
│ │ ─────────────────────────────────────────────────── │ │
│ │ Download Limit  1000 KiB/s      Per-torrent...      │ │
│ │ Upload Limit    500 KiB/s       Per-torrent...      │ │
│ └─────────────────────────────────────────────────────┘ │
│ ┌─────────────────────────────────────────────────────┐ │
│ │ Torrent: example.torrent                            │ │
│ │ Key              Value                              │ │
│ │ ─────────────────────────────────────────────────── │ │
│ │ Info Hash        abc123...                          │ │
│ │ Status           Active                             │ │
│ │ Progress         45.0%                              │ │
│ │ Current Down     1.2 MB/s (1171.9 KiB/s)          │ │
│ │ Current Up       500 B/s (0.5 KiB/s)               │ │
│ └─────────────────────────────────────────────────────┘ │
│ ┌─────────────────────────────────────────────────────┐ │
│ │ 性能指标                                 │ │
│ │ [Metrics displayed here]                            │ │
│ └─────────────────────────────────────────────────────┘ │
│ ┌─────────────────────────────────────────────────────┐ │
│ │ Configuration Inputs                                │ │
│ │ Download Limit (KiB/s, 0 = unlimited):              │ │
│ │ [1000________________________________]              │ │
│ │ Upload Limit (KiB/s, 0 = unlimited):                │ │
│ │ [500_________________________________]              │ │
│ │ Queue 优先级:                                     │ │
│ │ [normal________________________________]            │ │
│ └─────────────────────────────────────────────────────┘ │
│ ┌─────────────────────────────────────────────────────┐ │
│ │ Queue Configuration                                 │ │
│ │ Key              Value                              │ │
│ │ ─────────────────────────────────────────────────── │ │
│ │ Queue Status     优先级: NORMAL, Position: 3     │ │
│ └─────────────────────────────────────────────────────┘ │
│ ┌─────────────────────────────────────────────────────┐ │
│ │ 文件 Section                                       │ │
│ │ [文件 information displayed here]                  │ │
│ └─────────────────────────────────────────────────────┘ │
│ ┌─────────────────────────────────────────────────────┐ │
│ │ Operations                                          │ │
│ │ [Announce] [Scrape] [PEX] [Rehash] [Pause] [Resume] │ │
│ └─────────────────────────────────────────────────────┘ │
│ [Save] [Reset Limits] [Manage 文件] [取消]          │
├─────────────────────────────────────────────────────────┤
│ Footer (Back: Esc, 退出: q, Announce: a, Scrape: s...) │
└─────────────────────────────────────────────────────────┘
```

### 文件 选择ion Screen
```
┌─────────────────────────────────────────────────────────┐
│ 文件 选择ion                                           │
├─────────────────────────────────────────────────────────┤
│ ┌─────────────────────────────────────────────────────┐ │
│ │ 文件 Table                                         │ │
│ │ #  选择ed  优先级  Progress  大小    文件 Name │ │
│ │ ─────────────────────────────────────────────────── │ │
│ │ 0  ✓         normal    100.0%    500 MB  file1.mp4 │ │
│ │ 1  ✓         high      45.0%     1.2 GB  file2.mkv │ │
│ │ 2            normal    0.0%      300 MB  file3.srt  │ │
│ │ 3  ✓         low       78.0%     800 MB  file4.avi  │ │
│ └─────────────────────────────────────────────────────┘ │
│ ┌─────────────────────────────────────────────────────┐ │
│ │ 文件 选择ion Status                               │ │
│ │ Total: 4 | 选择ed: 3 | Deselected: 1              │ │
│ └─────────────────────────────────────────────────────┘ │
│ Commands: Space=Toggle, A=选择 All, D=Deselect All,  │
│           P=优先级, S=Save, Esc=Back                  │
└─────────────────────────────────────────────────────────┘
```

### Add Torrent Screen (Multi-step Form)
```
┌─────────────────────────────────────────────────────────┐
│ Step 1/11: 1 → 2 → 3 → 4 → 5 → 6 → 7 → 8 → 9 → 10 → 11│
├─────────────────────────────────────────────────────────┤
│ ┌─────────────────────────────────────────────────────┐ │
│ │ 步骤 1: 种子输入                               │ │
│ │                                                     │ │
│ │ Enter torrent path or magnet URI:                  │ │
│ │ [magnet:?xt=urn:btih:abc123...________________]    │ │
│ │                                                     │ │
│ │ Or browse for .torrent file                         │ │
│ └─────────────────────────────────────────────────────┘ │
│                                                          │
│ [取消]                    [上一步] [下一步] [提交] │
└─────────────────────────────────────────────────────────┘

步骤 2: 输出目录
Step 3: 文件 选择ion
步骤 4: 速率限制
步骤 5: 队列优先级
步骤 6: 恢复选项
Step 7: Xet Options
Step 8: IPFS Options
步骤 9: 抓取选项
Step 10: uTP Options
Step 11: NAT Options
```

### Xet 管理 Screen
```
┌─────────────────────────────────────────────────────────┐
│ Header                                                   │
├─────────────────────────────────────────────────────────┤
│ ┌─────────────────────────────────────────────────────┐ │
│ │ Xet Protocol Status                                 │ │
│ │ Enabled: Yes                                        │ │
│ │ 去重: Enabled                              │ │
│ │ P2P CAS: Enabled                                    │ │
│ │ 压缩: Enabled                                │ │
│ │ Chunk size range: 512-16384 bytes                   │ │
│ │ Target chunk size: 8192 bytes                       │ │
│ │ Cache DB: /path/to/cache.db                         │ │
│ │ Chunk store: /path/to/chunks                        │ │
│ │                                                     │ │
│ │ Runtime Status:                                     │ │
│ │   Protocol state: active                            │ │
│ │   P2P CAS client: Active                            │ │
│ └─────────────────────────────────────────────────────┘ │
│ ┌─────────────────────────────────────────────────────┐ │
│ │ Xet Deduplication Cache Statistics                  │ │
│ │ Metric              Value                           │ │
│ │ ─────────────────────────────────────────────────── │ │
│ │ Total chunks        10,000                          │ │
│ │ Unique chunks       5,000                           │ │
│ │ Total size          5.2 GB                          │ │
│ │ Cache size          2.6 GB                          │ │
│ │ Average chunk size  8192 bytes                      │ │
│ │ Deduplication ratio 2.0                            │ │
│ └─────────────────────────────────────────────────────┘ │
│ ┌─────────────────────────────────────────────────────┐ │
│ │ Xet 性能指标                             │ │
│ │ Metric                      Value                   │ │
│ │ ─────────────────────────────────────────────────── │ │
│ │ Deduplication Efficiency    50.0%                   │ │
│ │ Space Saved                 2.6 GB (50.0%)         │ │
│ │ Deduplication Ratio         2.0x                    │ │
│ │ Average Chunk 大小          8.0 KB                  │ │
│ └─────────────────────────────────────────────────────┘ │
│ [Enable] [Disable] [Refresh] [Cache Info] [Cleanup]    │
├─────────────────────────────────────────────────────────┤
│ Footer (Back: Esc, 退出: q, Enable: e, Disable: d...)  │
└─────────────────────────────────────────────────────────┘
```

### IPFS 管理 Screen
```
┌─────────────────────────────────────────────────────────┐
│ Header                                                   │
├─────────────────────────────────────────────────────────┤
│ ┌─────────────────────────────────────────────────────┐ │
│ │ IPFS Protocol Status                                │ │
│ │ Connection: Connected                               │ │
│ │ Protocol state: active                              │ │
│ │ IPFS API URL: http://localhost:5001                 │ │
│ │ Gateway URLs: 2                                      │ │
│ │ Connected: Yes                                      │ │
│ │ Connected peers: 15                                 │ │
│ │ Content items: 25                                   │ │
│ │ Pinned items: 10                                    │ │
│ └─────────────────────────────────────────────────────┘ │
│ ┌─────────────────────────────────────────────────────┐ │
│ │ IPFS 性能指标                            │ │
│ │ [Performance metrics displayed here]                │ │
│ └─────────────────────────────────────────────────────┘ │
│ ┌──────────────────────────┐ ┌──────────────────────┐ │
│ │ IPFS Content             │ │ IPFS Peers            │ │
│ │ CID          大小  Pin   │ │ Peer ID    Multiaddr │ │
│ │ ──────────── ───── ───── │ │ ────────── ──────────│ │
│ │ QmAbc123...  500MB  Yes  │ │ 12D3Koo... /ip4/... │ │
│ │ QmDef456...  1.2GB  No   │ │ 12D3Koo... /ip6/... │ │
│ └──────────────────────────┘ └──────────────────────┘ │
│ [Add 文件] [Get Content] [Pin] [Unpin] [Refresh]      │
├─────────────────────────────────────────────────────────┤
│ Footer (Back: Esc, 退出: q, Add: a, Get: g, Pin: p...) │
└─────────────────────────────────────────────────────────┘
```

### SSL 配置 Screen
```
┌─────────────────────────────────────────────────────────┐
│ Header                                                   │
├─────────────────────────────────────────────────────────┤
│ ┌─────────────────────────────────────────────────────┐ │
│ │ SSL/TLS Status                                      │ │
│ │ Tracker SSL: Enabled                                │ │
│ │ Peer SSL: Enabled                                   │ │
│ │ Certificate Verification: Enabled                   │ │
│ │ Protocol Version: TLSv1.3                           │ │
│ │ CA Certificates: /path/to/ca.crt                   │ │
│ │ Client Certificate: /path/to/client.crt             │ │
│ │ Client Key: Set                                     │ │
│ │ Allow Insecure Peers: No                            │ │
│ │ Cipher Suites: System default                       │ │
│ └─────────────────────────────────────────────────────┘ │
│ ┌─────────────────────────────────────────────────────┐ │
│ │ SSL/TLS Configuration                               │ │
│ │ Setting              Current Value    Action        │ │
│ │ ─────────────────────────────────────────────────── │ │
│ │ Tracker SSL          Enabled          Press 1/2    │ │
│ │ Peer SSL             Enabled          Press 3/4    │ │
│ │ Certificate Verify   Enabled          Press v/V    │ │
│ │ Protocol Version     TLSv1.3          Click Set... │ │
│ │ CA Certificates      /path/to/ca.crt   Click Set... │ │
│ │ Client Certificate   /path/to/client.crt Click...  │ │
│ └─────────────────────────────────────────────────────┘ │
│ ┌─────────────────────────────────────────────────────┐ │
│ │ SSL 性能指标                             │ │
│ │ [Performance metrics displayed here]                │ │
│ └─────────────────────────────────────────────────────┘ │
│ [Enable Trackers] [Disable Trackers] [Enable Peers]     │
│ [Disable Peers] [Set CA Certs] [Set Client Cert]        │
│ [Set Protocol] [Verify On] [Verify Off] [Refresh]       │
├─────────────────────────────────────────────────────────┤
│ Footer (Back: Esc, 退出: q, Refresh: r, Enable: 1/3...)│
└─────────────────────────────────────────────────────────┘
```

### 代理配置 Screen
```
┌─────────────────────────────────────────────────────────┐
│ Header                                                   │
├─────────────────────────────────────────────────────────┤
│ ┌─────────────────────────────────────────────────────┐ │
│ │ Proxy Status                                        │ │
│ │ Enabled: Yes                                        │ │
│ │ Type: SOCKS5                                        │ │
│ │ Host: proxy.example.com                             │ │
│ │ Port: 1080                                          │ │
│ │ Username: user                                      │ │
│ │ Password: ***                                      │ │
│ │ For Trackers: Yes                                  │ │
│ │ For Peers: Yes                                     │ │
│ │ For WebSeeds: No                                   │ │
│ │ Bypass List: localhost, 127.0.0.1                  │ │
│ └─────────────────────────────────────────────────────┘ │
│ ┌─────────────────────────────────────────────────────┐ │
│ │ Proxy Statistics                                    │ │
│ │ Metric              Value                           │ │
│ │ ─────────────────────────────────────────────────── │ │
│ │ Total Connections   1,234                          │ │
│ │ Successful          1,200                          │ │
│ │ Failed              34                             │ │
│ │ Auth Failures       2                              │ │
│ │ Timeouts            5                              │ │
│ │ Bytes Sent          500 MB                         │ │
│ │ Bytes Received      2.5 GB                         │ │
│ └─────────────────────────────────────────────────────┘ │
│ ┌─────────────────────────────────────────────────────┐ │
│ │ Proxy 性能指标                           │ │
│ │ [Performance metrics displayed here]                │ │
│ └─────────────────────────────────────────────────────┘ │
│ [Set Proxy] [Test Connection] [Disable] [Refresh]       │
├─────────────────────────────────────────────────────────┤
│ Footer (Back: Esc, 退出: q, Test: t, Refresh: r)       │
└─────────────────────────────────────────────────────────┘
```

### 抓取结果 Screen
```
┌─────────────────────────────────────────────────────────┐
│ Header                                                   │
├─────────────────────────────────────────────────────────┤
│ ┌─────────────────────────────────────────────────────┐ │
│ │ Scrape Cache Status                                 │ │
│ │ Total cached results: 25                            │ │
│ │                                                     │ │
│ │ Scrape results show tracker statistics (seeders,   │ │
│ │ leechers, completed downloads).                    │ │
│ │ Results are cached to avoid excessive tracker...    │ │
│ └─────────────────────────────────────────────────────┘ │
│ ┌─────────────────────────────────────────────────────┐ │
│ │ Cached 抓取结果                               │ │
│ │ Info Hash      Seeders  Leechers  Completed  Count │ │
│ │ ─────────────────────────────────────────────────── │ │
│ │ abc123...      1,234    567       5,678     15     │ │
│ │ def456...      890      234       3,456     12     │ │
│ │ ghi789...      567      123       2,345     8      │ │
│ │ ...                                                │ │
│ └─────────────────────────────────────────────────────┘ │
│ [Refresh] [Scrape All]                                   │
├─────────────────────────────────────────────────────────┤
│ Footer (Back: Esc, 退出: q, Refresh: r)                 │
└─────────────────────────────────────────────────────────┘
```

### NAT 管理 Screen
```
┌─────────────────────────────────────────────────────────┐
│ Header                                                   │
├─────────────────────────────────────────────────────────┤
│ ┌─────────────────────────────────────────────────────┐ │
│ │ NAT Traversal Status                                │ │
│ │ Active Protocol: UPnP                               │ │
│ │ External IP: 203.0.113.42                          │ │
│ │                                                     │ │
│ │ Configuration:                                      │ │
│ │   Auto-map ports: Yes                              │ │
│ │   NAT-PMP enabled: Yes                             │ │
│ │   UPnP enabled: Yes                                 │ │
│ └─────────────────────────────────────────────────────┘ │
│ ┌─────────────────────────────────────────────────────┐ │
│ │ NAT 性能指标                             │ │
│ │ [Performance metrics displayed here]                │ │
│ └─────────────────────────────────────────────────────┘ │
│ ┌─────────────────────────────────────────────────────┐ │
│ │ Active Port Mappings                                │ │
│ │ Protocol  Internal  External  Source    Expires    │ │
│ │ ─────────────────────────────────────────────────── │ │
│ │ TCP       6881      6881      UPnP      3600s      │ │
│ │ UDP       6881      6881      UPnP      3600s      │ │
│ └─────────────────────────────────────────────────────┘ │
│ [Discover] [Map Port] [Unmap Port] [External IP] [Refresh]│
├─────────────────────────────────────────────────────────┤
│ Footer (Back: Esc, 退出: q, Discover: d, Refresh: r)    │
└─────────────────────────────────────────────────────────┘
```

### uTP 配置 Screen
```
┌─────────────────────────────────────────────────────────┐
│ Header                                                   │
├─────────────────────────────────────────────────────────┤
│ ┌─────────────────────────────────────────────────────┐ │
│ │ uTP Status                                          │ │
│ │ Enabled: Yes                                        │ │
│ │                                                     │ │
│ │ uTP provides reliable, ordered delivery over UDP    │ │
│ │ with delay-based congestion control (BEP 29).      │ │
│ └─────────────────────────────────────────────────────┘ │
│ ┌─────────────────────────────────────────────────────┐ │
│ │ uTP 配置uration                                   │ │
│ │ Setting                  Value          Description │ │
│ │ ─────────────────────────────────────────────────── │ │
│ │ Prefer over TCP          true           Prefer uTP..│ │
│ │ Connection Timeout       30s            Connection..│ │
│ │ Max Window 大小          2,097,152 bytes Max receive│ │
│ │ MTU                      1,500 bytes    Maximum...  │ │
│ │ Initial Rate             64,000 B/s     Initial...  │ │
│ │ Min Rate                 1,000 B/s      Minimum...  │ │
│ │ Max Rate                 10,000,000 B/s Maximum...  │ │
│ │ ACK Interval             0.1s           ACK packet..│ │
│ │ Retransmit Timeout       2.0            RTT...      │ │
│ │ Max Retransmits          5              Maximum...  │ │
│ └─────────────────────────────────────────────────────┘ │
│ [Enable] [Disable] [Config Get] [Config Set] [Config   │
│ Reset] [Refresh]                                         │
├─────────────────────────────────────────────────────────┤
│ Footer (Back: Esc, 退出: q, Enable: e, Disable: d...)   │
└─────────────────────────────────────────────────────────┘
```

### Confirmation Dialog (Modal)
```
┌─────────────────────────────────────────────────────────┐
│                                                          │
│              ┌────────────────────────────┐              │
│              │ Confirmation              │              │
│              ├────────────────────────────┤              │
│              │                            │              │
│              │ Are you sure you want to   │              │
│              │ delete this torrent?        │              │
│              │                            │              │
│              │                            │              │
│              │    [Yes]        [No]       │              │
│              └────────────────────────────┘              │
│                                                          │
└─────────────────────────────────────────────────────────┘
```



## 功能

### 实时更新
实时种子状态和进度跟踪，按可配置的间隔更新。参见 [ccbt/interface/terminal_dashboard.py:_poll_once](https://github.com/yourusername/ccbittorrent/blob/main/ccbt/interface/terminal_dashboard.py#L389)。

### 对等节点监控
查看已连接的对等节点、其速度和客户端信息。参见 [ccbt/interface/terminal_dashboard.py:PeersTable](https://github.com/yourusername/ccbittorrent/blob/main/ccbt/interface/terminal_dashboard.py#L228)。

### 速度可视化
带有迷你图的下载/上传速度图表。参见 [ccbt/interface/terminal_dashboard.py:SpeedSparklines](https://github.com/yourusername/ccbittorrent/blob/main/ccbt/interface/terminal_dashboard.py#L250)。

### 警报系统
重要事件的实时通知。警报显示参见 [ccbt/interface/terminal_dashboard.py:491](https://github.com/yourusername/ccbittorrent/blob/main/ccbt/interface/terminal_dashboard.py#L491)。

### 交互式控制
常用操作的键盘快捷键。参见 [ccbt/interface/terminal_dashboard.py:on_key](https://github.com/yourusername/ccbittorrent/blob/main/ccbt/interface/terminal_dashboard.py#L3240)。

### 多种子支持
同时监控多个下载。参见 [ccbt/interface/terminal_dashboard.py:TorrentsTable](https://github.com/yourusername/ccbittorrent/blob/main/ccbt/interface/terminal_dashboard.py#L221)。

### 监控屏幕
用于详细监控指标的专用屏幕：
- **系统资源** (`s`) - CPU、内存、磁盘、网络 I/O 使用率
- **性能指标** (`m`) - 来自 MetricsCollector 和 MetricsPlugin 的性能数据
- **网络质量** (`n`) - 对等节点连接质量和网络统计
- **历史趋势** (`h`) - 带有迷你图的历史指标趋势
- **警报仪表板** (`a`) - 警报规则、活动警报和警报历史
- **指标浏览器** (`e`) - 浏览和探索所有可用指标

详细信息请参见[监控屏幕](#monitoring-screens)部分。

## 仪表板布局

仪表板使用 [Textual](https://textual.textualize.io/) 构建，并组织成面板：

### 布局结构
- **页眉**：时钟和应用程序标题。参见 [ccbt/interface/terminal_dashboard.py:323](https://github.com/yourusername/ccbittorrent/blob/main/ccbt/interface/terminal_dashboard.py#L323)
- **主体**：分为左右两部分。参见 [ccbt/interface/terminal_dashboard.py:324](https://github.com/yourusername/ccbittorrent/blob/main/ccbt/interface/terminal_dashboard.py#L324)
- **左面板**：概览和速度图表
- **右面板**：种子、对等节点、详细信息和日志
- **页脚**：状态栏和警报。参见 [ccbt/interface/terminal_dashboard.py:333-334](https://github.com/yourusername/ccbittorrent/blob/main/ccbt/interface/terminal_dashboard.py#L333-L334)

CSS 样式： [ccbt/interface/terminal_dashboard.py:279-297](https://github.com/yourusername/ccbittorrent/blob/main/ccbt/interface/terminal_dashboard.py#L279-L297)

### Panels

#### 概览面板
显示全局统计信息。实现： [ccbt/interface/terminal_dashboard.py:Overview](https://github.com/yourusername/ccbittorrent/blob/main/ccbt/interface/terminal_dashboard.py#L174)
- 下载速度：当前全局下载速率
- 上传速度：当前全局上传速率
- 已连接对等节点：已连接对等节点的总数
- 活动种子：正在下载/做种的种子数量
- 平均进度：总体进度百分比

#### 种子面板
在表格中显示所有活动种子。实现： [ccbt/interface/terminal_dashboard.py:TorrentsTable](https://github.com/yourusername/ccbittorrent/blob/main/ccbt/interface/terminal_dashboard.py#L196)
- 信息哈希：种子标识符
- 名称：种子名称
- 状态：当前状态（下载中、做种中、已暂停）
- 进度：完成百分比
- 下载/上传速率：传输速度

#### 对等节点面板
显示所选种子的对等节点。实现： [ccbt/interface/terminal_dashboard.py:PeersTable](https://github.com/yourusername/ccbittorrent/blob/main/ccbt/interface/terminal_dashboard.py#L228)
- IP 地址：对等节点的 IP 地址
- 端口：对等节点的端口
- 下载/上传速率：与对等节点的传输速度
- 阻塞：对等节点是否被阻塞
- 客户端：BitTorrent 客户端标识

#### 速度迷你图
实时速度可视化。实现： [ccbt/interface/terminal_dashboard.py:SpeedSparklines](https://github.com/yourusername/ccbittorrent/blob/main/ccbt/interface/terminal_dashboard.py#L250)
- 下载图表：显示下载速度历史的迷你图
- 上传图表：显示上传速度历史的迷你图
- 保持最后 120 个样本（1 秒刷新时约 2 分钟）。参见 [ccbt/interface/terminal_dashboard.py:269](https://github.com/yourusername/ccbittorrent/blob/main/ccbt/interface/terminal_dashboard.py#L269)

#### 详细信息面板
显示所选种子的详细信息。实现： [ccbt/interface/terminal_dashboard.py:428-439](https://github.com/yourusername/ccbittorrent/blob/main/ccbt/interface/terminal_dashboard.py#L428-L439)

#### 警报面板
显示警报规则和活动警报。实现： [ccbt/interface/terminal_dashboard.py:3059-3102](https://github.com/yourusername/ccbittorrent/blob/main/ccbt/interface/terminal_dashboard.py#L3059-L3102)

## 监控屏幕

Bitonic 提供从主仪表板访问的专用监控屏幕。每个屏幕专注于具有详细指标和可视化的特定监控领域。

### 系统资源屏幕

**访问**：从主仪表板按 `s`

**目的**：显示系统资源使用情况（CPU、内存、磁盘、网络 I/O）。

**功能**：
- 带进度条的 CPU 使用百分比
- 带进度条的内存使用百分比
- 带进度条的磁盘使用百分比
- 进程数
- 网络 I/O 统计（发送/接收的字节数）

**实现**： [ccbt/interface/terminal_dashboard.py:SystemResourcesScreen](https://github.com/yourusername/ccbittorrent/blob/main/ccbt/interface/terminal_dashboard.py#L690)

**导航**：按 `Escape` 或 `q` 返回主仪表板

### 性能指标屏幕

**访问**：从主仪表板按 `m`

**目的**：显示来自 MetricsCollector 和 MetricsPlugin 的性能指标。

**功能**：
- 对等节点连接数
- 下载/上传速度
- 片段完成/失败统计
- 跟踪器请求/响应统计
- 来自 MetricsPlugin 的事件驱动指标（如果可用）
- 指标收集统计

**实现**： [ccbt/interface/terminal_dashboard.py:PerformanceMetricsScreen](https://github.com/yourusername/ccbittorrent/blob/main/ccbt/interface/terminal_dashboard.py#L811)

**数据源**：
- `MetricsCollector.get_performance_metrics()`
- `MetricsCollector.get_metrics_statistics()`
- `MetricsPlugin.get_aggregates()`（如果可用）

**导航**：按 `Escape` 或 `q` 返回主仪表板

### 网络质量屏幕

**访问**：从主仪表板按 `n`

**目的**：显示对等节点和连接的网络质量指标。

**功能**：
- 全局网络统计
- 每个种子的网络质量表
- 带视觉指示器的对等节点连接质量指标
- 连接质量评分（0-100）

**实现**： [ccbt/interface/terminal_dashboard.py:NetworkQualityScreen](https://github.com/yourusername/ccbittorrent/blob/main/ccbt/interface/terminal_dashboard.py#L889)

**质量计算**：
- 基于对等节点速度和阻塞状态
- 视觉指示器：████████（优秀）、██████░░（良好）、████░░░░（一般）、██░░░░░░（差）

**导航**：按 `Escape` 或 `q` 返回主仪表板

### 历史趋势屏幕

**访问**：从主仪表板按 `h`

**目的**：使用迷你图显示各种指标的历史趋势。

**功能**：
- 用于不同指标的多个迷你图小部件
- 历史数据存储（最后 120 个样本，约 2 分钟）
- 包含当前、最小值、最大值和平均值的摘要表
- 自动指标格式化（速率、百分比、计数）

**跟踪的指标**：
- 下载/上传速率
- CPU 使用率
- 内存使用率
- 对等节点连接

**实现**： [ccbt/interface/terminal_dashboard.py:HistoricalTrendsScreen](https://github.com/yourusername/ccbittorrent/blob/main/ccbt/interface/terminal_dashboard.py#L1059)

**导航**：按 `Escape` 或 `q` 返回主仪表板

### 警报仪表板屏幕

**访问**：从主仪表板按 `a`

**目的**：具有过滤和管理功能的增强警报显示。

**功能**：
- 警报规则表（名称、指标、条件、严重程度、启用状态）
- 活动警报表（严重程度、规则、指标、值、时间戳）
- 警报历史（最后 50 个警报，带解决状态）
- 警报统计（已触发、已解决、已发送的通知）

**实现**： [ccbt/interface/terminal_dashboard.py:AlertsDashboardScreen](https://github.com/yourusername/ccbittorrent/blob/main/ccbt/interface/terminal_dashboard.py#L1201)

**严重程度格式**：
- **CRITICAL**：粗体红色
- **ERROR**：红色
- **WARNING**：黄色
- **INFO**：暗淡

**导航**：按 `Escape` 或 `q` 返回主仪表板

### 指标浏览器屏幕

**访问**：从主仪表板按 `e`

**目的**：通过过滤和详细视图探索所有可用指标。

**功能**：
- 来自 MetricsCollector 的完整指标列表
- 按指标名称或描述过滤/搜索
- 详细指标信息面板
- 指标类型、描述、聚合、保留
- 当前值和聚合值
- 标签和元数据

**实现**： [ccbt/interface/terminal_dashboard.py:MetricsExplorerScreen](https://github.com/yourusername/ccbittorrent/blob/main/ccbt/interface/terminal_dashboard.py#L1376)

**使用方法**：
- 在过滤器输入中键入并按 `Enter` 过滤指标
- 使用箭头键导航以选择指标
- 在下面的详细信息面板中查看详细信息

**导航**：按 `Escape` 或 `q` 返回主仪表板

## 配置屏幕

Bitonic 提供用于管理全局和每个种子设置的配置屏幕。

### 全局配置屏幕

**访问**：从主仪表板按 `g`

**目的**：配置全局应用程序设置。

**功能**：
- 基于部分的配置导航
- 带验证的可编辑配置字段
- 保存到运行时或文件
- 带确认对话框的未保存更改检测

**实现**： [ccbt/interface/terminal_dashboard.py:GlobalConfigMainScreen](https://github.com/yourusername/ccbittorrent/blob/main/ccbt/interface/terminal_dashboard.py#L1793)

**可用部分**：
- 网络配置
- 磁盘 I/O 设置
- 发现（DHT、PEX、跟踪器）
- 可观测性（日志、指标、跟踪）
- 安全设置
- 以及更多...

**导航**：按 `Escape` 或 `q` 返回主仪表板

### 每个种子配置屏幕

**访问**：从主仪表板按 `t`

**目的**：配置单个种子的设置。

**功能**：
- 种子选择界面
- 速率限制配置（下载/上传）
- 队列优先级管理
- 文件选择状态
- 种子操作（宣布、抓取、暂停、恢复等）

**实现**： [ccbt/interface/terminal_dashboard.py:PerTorrentConfigMainScreen](https://github.com/yourusername/ccbittorrent/blob/main/ccbt/interface/terminal_dashboard.py#L2241)

**可用操作**：
- 设置速率限制（KiB/s，0 = 无限制）
- 更改队列优先级
- 强制宣布（`a` 键）
- 强制抓取（`s` 键）
- 刷新 PEX（`e` 键）
- 重新哈希种子（`h` 键）
- 暂停/恢复种子（`p`/`r` 键）
- 删除种子（`Delete` 键）

**导航**：按 `Escape` 或 `q` 返回主仪表板

## 键盘快捷键

所有键盘快捷键在 [ccbt/interface/terminal_dashboard.py:on_key](https://github.com/yourusername/ccbittorrent/blob/main/ccbt/interface/terminal_dashboard.py#L505) 和 [ccbt/interface/terminal_dashboard.py:BINDINGS](https://github.com/yourusername/ccbittorrent/blob/main/ccbt/interface/terminal_dashboard.py#L337) 中定义。

### 导航
- `↑/↓` - 导航种子列表（DataTable 导航）
- `Enter` - 处理文件浏览器选择。参见 [ccbt/interface/terminal_dashboard.py:714](https://github.com/yourusername/ccbittorrent/blob/main/ccbt/interface/terminal_dashboard.py#L714)

### 种子控制
- `P` / `p` - 暂停所选种子。参见 [ccbt/interface/terminal_dashboard.py:534](https://github.com/yourusername/ccbittorrent/blob/main/ccbt/interface/terminal_dashboard.py#L534)
- `R` / `r` - 恢复所选种子。参见 [ccbt/interface/terminal_dashboard.py:541](https://github.com/yourusername/ccbittorrent/blob/main/ccbt/interface/terminal_dashboard.py#L541)
- `Delete` - 删除所选种子（带确认）。参见 [ccbt/interface/terminal_dashboard.py:510](https://github.com/yourusername/ccbittorrent/blob/main/ccbt/interface/terminal_dashboard.py#L510)
- `y` - 确认删除。参见 [ccbt/interface/terminal_dashboard.py:523](https://github.com/yourusername/ccbittorrent/blob/main/ccbt/interface/terminal_dashboard.py#L523)
- `n` - 取消删除。参见 [ccbt/interface/terminal_dashboard.py:530](https://github.com/yourusername/ccbittorrent/blob/main/ccbt/interface/terminal_dashboard.py#L530)

### 高级操作
- `a` / `A` - 强制宣布（选择种子时）。参见 [ccbt/interface/terminal_dashboard.py:3182](https://github.com/yourusername/ccbittorrent/blob/main/ccbt/interface/terminal_dashboard.py#L3182)
- `s` / `S` - 强制抓取（选择种子时）。参见 [ccbt/interface/terminal_dashboard.py:3197](https://github.com/yourusername/ccbittorrent/blob/main/ccbt/interface/terminal_dashboard.py#L3197)
- `e` / `E` - 刷新 PEX（选择种子时）。参见 [ccbt/interface/terminal_dashboard.py:3207](https://github.com/yourusername/ccbittorrent/blob/main/ccbt/interface/terminal_dashboard.py#L3207)
- `h` / `H` - 重新哈希种子（选择种子时）。参见 [ccbt/interface/terminal_dashboard.py:3217](https://github.com/yourusername/ccbittorrent/blob/main/ccbt/interface/terminal_dashboard.py#L3217)
- `x` / `X` - 导出会话快照。参见 [ccbt/interface/terminal_dashboard.py:3227](https://github.com/yourusername/ccbittorrent/blob/main/ccbt/interface/terminal_dashboard.py#L3227)

### 监控屏幕导航
- `s` - 打开系统资源屏幕。参见 [ccbt/interface/terminal_dashboard.py:action_system_resources](https://github.com/yourusername/ccbittorrent/blob/main/ccbt/interface/terminal_dashboard.py#L3880)
- `m` - 打开性能指标屏幕。参见 [ccbt/interface/terminal_dashboard.py:action_performance_metrics](https://github.com/yourusername/ccbittorrent/blob/main/ccbt/interface/terminal_dashboard.py#L3884)
- `n` - 打开网络质量屏幕。参见 [ccbt/interface/terminal_dashboard.py:action_network_quality](https://github.com/yourusername/ccbittorrent/blob/main/ccbt/interface/terminal_dashboard.py#L3888)
- `h` - 打开历史趋势屏幕。参见 [ccbt/interface/terminal_dashboard.py:action_historical_trends](https://github.com/yourusername/ccbittorrent/blob/main/ccbt/interface/terminal_dashboard.py#L3892)
- `a` - 打开警报仪表板屏幕。参见 [ccbt/interface/terminal_dashboard.py:action_alerts_dashboard](https://github.com/yourusername/ccbittorrent/blob/main/ccbt/interface/terminal_dashboard.py#L3896)
- `e` - 打开指标浏览器屏幕。参见 [ccbt/interface/terminal_dashboard.py:action_metrics_explorer](https://github.com/yourusername/ccbittorrent/blob/main/ccbt/interface/terminal_dashboard.py#L3900)

### 配置屏幕
- `g` - 打开全局配置屏幕。参见 [ccbt/interface/terminal_dashboard.py:action_global_config](https://github.com/yourusername/ccbittorrent/blob/main/ccbt/interface/terminal_dashboard.py#L3870)
- `t` - 打开每个种子配置屏幕。参见 [ccbt/interface/terminal_dashboard.py:action_torrent_config](https://github.com/yourusername/ccbittorrent/blob/main/ccbt/interface/terminal_dashboard.py#L3875)

### 速率限制
- `1` - 禁用速率限制。参见 [ccbt/interface/terminal_dashboard.py:627](https://github.com/yourusername/ccbittorrent/blob/main/ccbt/interface/terminal_dashboard.py#L627)
- `2` - 将速率限制设置为 1024 KiB/s。参见 [ccbt/interface/terminal_dashboard.py:635](https://github.com/yourusername/ccbittorrent/blob/main/ccbt/interface/terminal_dashboard.py#L635)

### 仪表板控制
- `Q` / `q` - 退出仪表板。参见 [ccbt/interface/terminal_dashboard.py:507](https://github.com/yourusername/ccbittorrent/blob/main/ccbt/interface/terminal_dashboard.py#L507)
- `/` - 打开过滤器输入。参见 [ccbt/interface/terminal_dashboard.py:548](https://github.com/yourusername/ccbittorrent/blob/main/ccbt/interface/terminal_dashboard.py#L548)
- `:` - 打开命令面板。参见 [ccbt/interface/terminal_dashboard.py:561](https://github.com/yourusername/ccbittorrent/blob/main/ccbt/interface/terminal_dashboard.py#L561)
- `m` / `M` - 切换指标收集间隔。参见 [ccbt/interface/terminal_dashboard.py:645](https://github.com/yourusername/ccbittorrent/blob/main/ccbt/interface/terminal_dashboard.py#L645)
- `R` - 切换仪表板刷新间隔。参见 [ccbt/interface/terminal_dashboard.py:659](https://github.com/yourusername/ccbittorrent/blob/main/ccbt/interface/terminal_dashboard.py#L659)
- `t` / `T` - 切换浅色/深色主题。参见 [ccbt/interface/terminal_dashboard.py:673](https://github.com/yourusername/ccbittorrent/blob/main/ccbt/interface/terminal_dashboard.py#L673)
- `c` / `C` - 切换紧凑模式。参见 [ccbt/interface/terminal_dashboard.py:681](https://github.com/yourusername/ccbittorrent/blob/main/ccbt/interface/terminal_dashboard.py#L681)
- `k` / `K` - 确认所有活动警报。参见 [ccbt/interface/terminal_dashboard.py:723](https://github.com/yourusername/ccbittorrent/blob/main/ccbt/interface/terminal_dashboard.py#L723)

### 添加种子
- `i` / `I` - 快速添加种子。参见 [ccbt/interface/terminal_dashboard.py:702](https://github.com/yourusername/ccbittorrent/blob/main/ccbt/interface/terminal_dashboard.py#L702)
- `o` / `O` - 高级添加种子。参见 [ccbt/interface/terminal_dashboard.py:706](https://github.com/yourusername/ccbittorrent/blob/main/ccbt/interface/terminal_dashboard.py#L706)
- `b` / `B` - 浏览种子文件。参见 [ccbt/interface/terminal_dashboard.py:710](https://github.com/yourusername/ccbittorrent/blob/main/ccbt/interface/terminal_dashboard.py#L710)

## 配置

仪表板设置在 [ccbt.toml:185-191](https://github.com/yourusername/ccbittorrent/blob/main/ccbt.toml#L185-L191) 中配置：

- `refresh_interval`：UI 刷新间隔（秒）（默认值：1.0）
- `default_view`：默认仪表板视图

警报规则从 [ccbt.toml:170](https://github.com/yourusername/ccbittorrent/blob/main/ccbt.toml#L170) 中指定的路径（`alerts_rules_path`）加载。自动加载参见 [ccbt/interface/terminal_dashboard.py:363-381](https://github.com/yourusername/ccbittorrent/blob/main/ccbt/interface/terminal_dashboard.py#L363-L381)。

## 命令面板

按 `:` 打开命令面板。可用命令：
- `pause` - 暂停所选种子
- `resume` - 恢复所选种子
- `remove` - 删除所选种子
- `announce` - 强制宣布
- `scrape` - 强制抓取
- `pex` - 刷新 PEX
- `rehash` - 重新哈希种子
- `limit <down> <up>` - 设置速率限制（KiB/s）
- `backup <path>` - 备份检查点
- `restore <path>` - 恢复检查点

实现： [ccbt/interface/terminal_dashboard.py:_run_command](https://github.com/yourusername/ccbittorrent/blob/main/ccbt/interface/terminal_dashboard.py#L776)

## 过滤

按 `/` 按名称或状态过滤种子。实现： [ccbt/interface/terminal_dashboard.py:_apply_filter_and_update](https://github.com/yourusername/ccbittorrent/blob/main/ccbt/interface/terminal_dashboard.py#L762)

## 与监控的集成

Bitonic 与 ccBitTorrent 的监控系统集成：
- 通过 [ccbt/monitoring/metrics_collector.py](https://github.com/yourusername/ccbittorrent/blob/main/ccbt/monitoring/metrics_collector.py) 进行指标收集
- 通过 [ccbt/monitoring/alert_manager.py](https://github.com/yourusername/ccbittorrent/blob/main/ccbt/monitoring/alert_manager.py) 进行警报管理
- 通过 [ccbt/plugins/base.py](https://github.com/yourusername/ccbittorrent/blob/main/ccbt/plugins/base.py) 的插件系统
- 用于事件驱动指标的 MetricsPlugin 集成。参见 [ccbt/interface/terminal_dashboard.py:_get_metrics_plugin](https://github.com/yourusername/ccbittorrent/blob/main/ccbt/interface/terminal_dashboard.py#L626)
- 系统指标跟踪。参见 [ccbt/interface/terminal_dashboard.py:3001-3019](https://github.com/yourusername/ccbittorrent/blob/main/ccbt/interface/terminal_dashboard.py#L3001-L3019)

### 指标源

Bitonic 显示来自多个源的指标：

1. **MetricsCollector**：系统级和性能指标
   - CPU、内存、磁盘使用率
   - 网络 I/O 统计
   - 对等节点连接、速度、片段统计

2. **MetricsPlugin**：事件驱动指标
   - 片段下载速度
   - 种子平均速度
   - 基于事件的聚合

3. **AsyncSessionManager**：会话级统计
   - 全局下载/上传速率
   - 每个种子的状态
   - 对等节点信息

### 插件管理器集成

Bitonic 使用全局插件管理器单例来访问插件：
- 通过 `get_plugin_manager()` 函数访问。参见 [ccbt/plugins/base.py:get_plugin_manager](https://github.com/yourusername/ccbittorrent/blob/main/ccbt/plugins/base.py#L403)
- 通过多种方法发现 MetricsPlugin（PluginManager、事件总线、会话属性）
- 当插件不可用时的优雅处理

## 故障排除

### 仪表板无法启动
1. 检查是否安装了 Textual：`uv pip install textual>=0.73.0`
2. 验证终端支持 Unicode 和颜色
3. 检查终端中的错误消息

实现处理 Textual 可用性： [ccbt/interface/terminal_dashboard.py:46-172](https://github.com/yourusername/ccbittorrent/blob/main/ccbt/interface/terminal_dashboard.py#L46-L172)

### 性能问题
1. 增加刷新间隔：`--refresh 2.0` 或按 `R` 循环间隔
2. 使用紧凑模式：按 `c` 切换
3. 如果不需要，禁用速度图表

### 缺少数据
1. 确保种子正在积极下载
2. 检查网络连接
3. 验证对等节点连接已建立

## 架构

Bitonic 使用：
- **Textual**：终端 UI 框架。参见 [ccbt/interface/terminal_dashboard.py:47-60](https://github.com/yourusername/ccbittorrent/blob/main/ccbt/interface/terminal_dashboard.py#L47-L60)
- **Rich**：富文本和美观的格式
- **AsyncSessionManager**：会话管理。参见 [ccbt/session/session.py:AsyncSessionManager](https://github.com/yourusername/ccbittorrent/blob/main/ccbt/session/session.py#L605)
- **MetricsCollector**：指标收集（通过 `get_metrics_collector()` 的单例）
- **AlertManager**：警报管理（通过 `get_alert_manager()` 的单例）
- **PluginManager**：插件管理（通过 `get_plugin_manager()` 的单例）

### 屏幕架构

Bitonic 遵循分层屏幕结构：

```
TerminalDashboard (主应用)
├── ConfigScreen (基类)
│   ├── GlobalConfigMainScreen
│   ├── GlobalConfigDetailScreen
│   ├── PerTorrentConfigMainScreen
│   └── TorrentConfigDetailScreen
└── MonitoringScreen (基类)
    ├── SystemResourcesScreen
    ├── PerformanceMetricsScreen
    ├── NetworkQualityScreen
    ├── HistoricalTrendsScreen
    ├── AlertsDashboardScreen
    └── MetricsExplorerScreen
```

**基类**：
- **MonitoringScreen**：所有监控屏幕的基类，具有通用功能（刷新间隔、导航、错误处理）。参见 [ccbt/interface/terminal_dashboard.py:MonitoringScreen](https://github.com/yourusername/ccbittorrent/blob/main/ccbt/interface/terminal_dashboard.py#L558)
- **ConfigScreen**：配置屏幕的基类，具有未保存更改检测。参见 [ccbt/interface/terminal_dashboard.py:ConfigScreen](https://github.com/yourusername/ccbittorrent/blob/main/ccbt/interface/terminal_dashboard.py#L433)

**可重用小部件**：
- **ProgressBarWidget**：用于百分比的进度条。参见 [ccbt/interface/terminal_dashboard.py:ProgressBarWidget](https://github.com/yourusername/ccbittorrent/blob/main/ccbt/interface/terminal_dashboard.py#L309)
- **MetricsTableWidget**：表格格式的指标显示。参见 [ccbt/interface/terminal_dashboard.py:MetricsTableWidget](https://github.com/yourusername/ccbittorrent/blob/main/ccbt/interface/terminal_dashboard.py#L335)
- **SparklineGroup**：带标签的多个迷你图。参见 [ccbt/interface/terminal_dashboard.py:SparklineGroup](https://github.com/yourusername/ccbittorrent/blob/main/ccbt/interface/terminal_dashboard.py#L379)

**确认对话框**：
- **ConfirmationDialog**：用于确认提示的模态对话框（例如，未保存的更改）。参见 [ccbt/interface/terminal_dashboard.py:ConfirmationDialog](https://github.com/yourusername/ccbittorrent/blob/main/ccbt/interface/terminal_dashboard.py#L471)

更多信息，请参见：
- [API 参考](API.md) - 包括监控功能的 Python API 文档
- [btbt CLI 参考](btbt-cli.md) - 命令行界面